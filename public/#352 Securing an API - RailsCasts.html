<!DOCTYPE html>
<!-- saved from url=(0065)http://railscasts.com/episodes/352-securing-an-api?view=asciicast -->
<html id="sv"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>#352 Securing an API - RailsCasts</title>
    <meta name="description" content="Short Ruby on Rails screencasts containing tips, tricks and tutorials. Great for both novice and experienced web developers.">
    <meta name="keywords" content="rails, ruby on rails, screencasts, railscast, railscasts, tips, tricks, tutorials, training, podcasts, programming">
    <link rel="alternate" type="application/rss+xml" title="Episodes RSS" href="http://feeds.feedburner.com/railscasts">
    <link href="./#352 Securing an API - RailsCasts_files/application-54471fdecb1d2fe9e273e58b03f0c90e.css" media="screen" rel="stylesheet" type="text/css">
    <script type="text/javascript" async="" src="./#352 Securing an API - RailsCasts_files/ga.js"></script><script src="./#352 Securing an API - RailsCasts_files/3s7oes9q.js" type="text/javascript"></script>
    <script src="./#352 Securing an API - RailsCasts_files/application-01e0c20b94539b729328ce57b3999402.js" type="text/javascript"></script>
    <meta content="authenticity_token" name="csrf-param">
<meta content="7NN/usGUm2o7rMcAOzuw/AEmRalI9ybryNb4d61OnXk=" name="csrf-token">

  <script type="text/javascript" src="./#352 Securing an API - RailsCasts_files/sublime.js.jgz"></script></head>
  <body data-twttr-rendered="true">
    <div id="top">
      <div class="logo"><a href="http://railscasts.com/"><img alt="RailsCasts - Ruby on Rails Screencasts" height="56" src="./#352 Securing an API - RailsCasts_files/railscasts_logo-1eeafbafc2154fc5340c0a9800f402fd.png" width="423"></a></div>
      <div class="user_nav">
          <a href="http://railscasts.com/login">Sign in through GitHub</a>
      </div>
      <ul class="subscribe horizontal">
        <li>
          <a href="http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=218282043"><img alt="Itunes" height="34" src="./#352 Securing an API - RailsCasts_files/itunes-ef71b73d72d4058704c696cb380a4748.png" width="34"></a>
          <span class="name">watch on iTunes</span>
        </li>
        <li>
          <a href="http://twitter.com/railscasts"><img alt="Twitter" height="34" src="./#352 Securing an API - RailsCasts_files/twitter-4f826eafef2e2eb45e551a01de2c99da.png" width="34"></a>
          <span class="name">follow on Twitter</span>
        </li>
        <li>
          <a href="http://www.facebook.com/pages/railscasts/197415140659"><img alt="Facebook" height="34" src="./#352 Securing an API - RailsCasts_files/facebook-908bce1aba280b31a02b45cd2b411038.png" width="34"></a>
          <span class="name">follow on Facebook</span>
        </li>
        <li>
          <a href="http://feeds.feedburner.com/railscasts"><img alt="Rss" height="34" src="./#352 Securing an API - RailsCasts_files/rss-3188609a3d271a8245d75cfb3472a237.png" width="34"></a>
          <span class="name">subscribe to RSS feed</span>
        </li>
      </ul>
    </div>

    <div id="nav_bar">
      <ul class="nav horizontal">
        <li><a href="http://railscasts.com/">Browse Episodes</a></li>
        <li><a href="http://railscasts.com/pro">RailsCasts Pro</a></li>
        <li><a href="http://railscasts.com/about">About</a></li>
        <li><a href="http://railscasts.com/feedback">Feedback</a></li>
      </ul>
      <form accept-charset="UTF-8" action="http://railscasts.com/episodes" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
        <input id="search" name="search" size="35" type="text">
        <input type="submit" value="Search Episodes">
</form>    </div>

    <div id="announcement_banner">
  <p>Taking a break for the holidays, here's a free week to subscribers!</p>

  <p><a href="http://railscasts.com/announcements/5">Learn more</a> or <a href="http://railscasts.com/announcements/5/hide" data-remote="true">hide this</a></p>
</div>



    <div id="main">


  <div id="episode">
    <script id="video_template" type="text/html"><video width="960" height="600" poster="/static/episodes/posters/loading.png" controls="controls" preload="none" class="sv_force_fullscreen sv_force_flash"><source src="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.mp4" type="video/mp4"/><source src="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.m4v" type="video/mp4"/><source src="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.webm" type="video/webm"/><source src="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.ogv" type="video/ogg"/></video></script>
    <div class="info">
      <div class="screenshot"><a href="http://railscasts.com/episodes/352-securing-an-api?autoplay=true" class="play_video"><img alt="Securing an API" height="125" src="./#352 Securing an API - RailsCasts_files/352-securing-an-api.png" width="200"></a></div>
      <h1><span class="position">#352</span> Securing an API</h1>
      <div class="details">May 23, 2012 | 7 minutes | <a href="http://railscasts.com/?tag_id=5">Security</a>, <a href="http://railscasts.com/?tag_id=37">APIs</a></div>
      <div class="description">There are many approaches to locking down an API. Here I start off with HTTP Basic authentication then move on to generating a unique token which can be passed through a URL parameter or HTTP header.</div>
      <div class="watch"><a href="http://railscasts.com/episodes/352-securing-an-api?autoplay=true" class="play_video pretty_button">Click to Play Video ▶</a></div>
      <div class="social"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="./#352 Securing an API - RailsCasts_files/tweet_button.1355514129.html" class="twitter-share-button twitter-count-horizontal" style="width: 107px; height: 20px;" title="Twitter Tweet Button" data-twttr-rendered="true"></iframe><script src="./#352 Securing an API - RailsCasts_files/widgets.js" type="text/javascript"></script></div>
        <ul class="downloads horizontal">
          <li>Download:</li>
          <li><a href="http://media.railscasts.com/assets/episodes/sources/352-securing-an-api.zip">source code</a><span class="overlay">Project Files in Zip (95.7 KB)</span></li><li><a href="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.mp4">mp4</a><span class="overlay">Full Size H.264 Video (20 MB)</span></li><li><a href="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.m4v">m4v</a><span class="overlay">Smaller H.264 Video (9.66 MB)</span></li><li><a href="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.webm">webm</a><span class="overlay">Full Size VP8 Video (7.81 MB)</span></li><li><a href="http://media.railscasts.com/assets/episodes/videos/352-securing-an-api.ogv">ogv</a><span class="overlay">Full Size Theora Video (25.9 MB)</span></li>
        </ul>
      <div class="clear"></div>
</div>    <ul class="nav horizontal"><li class="selected"><a href="http://railscasts.com/episodes/352-securing-an-api" class="tab">Show Notes</a></li><li><a href="./#352 Securing an API - RailsCasts_files/#352 Securing an API - RailsCasts.html" class="selected tab">ASCIIcast</a></li><li><a href="http://railscasts.com/episodes/352-securing-an-api?view=comments" class="tab">15 Comments</a></li><li><a href="http://railscasts.com/episodes/352-securing-an-api?view=similar" class="tab">Similar Episodes</a></li><li class="next"><a href="http://railscasts.com/episodes/353-oauth-with-doorkeeper">Next Episode &gt;</a></li><li class="previous"><a href="http://railscasts.com/episodes/154-polymorphic-association-revised">&lt; Previous Episode</a></li></ul>
    <div class="nav_section">
      <div class="inner">  <div class="asciicast">
      <div class="languages">
          <a href="http://railscasts.com/episodes/352-securing-an-api?language=ja&view=asciicast"><img alt="Ja" height="32" src="./#352 Securing an API - RailsCasts_files/ja.png" width="32"></a>
          <a href="http://railscasts.com/episodes/352-securing-an-api?language=es&view=asciicast"><img alt="Es" height="32" src="./#352 Securing an API - RailsCasts_files/es.png" width="32"></a>
      </div>
    <p>Last week, in <a href="http://railscasts.com/episodes/350-rest-api-versioning">episode 350</a>, we showed you how to build a versioned API for a store application. We can interact with this application through JSON if we visit the path <code>/api/products</code>. This API is completely public so anyone can use it to edit or destroy the products but usually we want to restrict access to an API. There are a variety of ways that we can do this and the correct technique depends on our application’s requirements. In this episode we’ll show several solutions that we can use to lock down an API so that you can choose the one that best fits your style of application.</p>

<h3>Using HTTP Basic Authentication</h3>

<p>One of the simplest options is HTTP Basic Authentication. This is incredibly easy to do in Rails and most API clients should have no problem supporting it. To use it we just need to modify the controller that serves the API with a call to <code>http_basic_authentication_with</code>, passing it a name and a password.</p>

      <div class="code_block">
        <div class="code_header">
          /app/controllers/api/v1/products_controller.rb
        </div>
        <div class="CodeRay">
  <div class="code"><pre><span class="r">module</span> <span class="cl">Api</span>
  <span class="r">module</span> <span class="cl">V1</span>
    <span class="r">class</span> <span class="cl">ProductsController</span> &amp;amp;lt; <span class="co">ApplicationController</span>
      http_basic_authenticate_with <span class="sy">name:</span> &amp;amp;quot;admin&amp;amp;quot;, <span class="sy">password:</span> &amp;amp;quot;secret&amp;amp;quot;
      respond_to <span class="sy">:json</span>

      <span class="c"># Actions omitten</span>
    <span class="r">end</span>
  <span class="r">end</span>
<span class="r">end</span></pre></div>
</div>

      </div>

<p>In a real application we’d move the name and password into some kind of external configuration so that they aren’t stored in version control. If we need to do this in multiple controllers we could move it into a new controller and then subclass the other controllers from it.</p>

<p>We can use the <code>curl</code> command to test this out. If we make a request to our API’s path we now get an error.</p>

      <div class="code_block">
        <div class="code_header">
          terminal
        </div>
        <div class="CodeRay">
  <div class="code"><pre>$ curl http://localhost:3000/api/products
HTTP Basic: Access denied.</pre></div>
</div>

      </div>

<p>If we look at the response headers we’ll see that we get a <code>401 Unauthorized</code> response.</p>

      <div class="code_block">
        <div class="code_header">
          terminal
        </div>
        <div class="CodeRay">
  <div class="code"><pre>$ curl http://localhost:3000/api/products -I
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Basic realm="Application"
Content-Type: text/html; charset=utf-8
X-UA-Compatible: IE=Edge
Cache-Control: no-cache
X-Request-Id: c411eeceefc39ab3964d40301530843c
X-Runtime: 0.002366
Content-Length: 0
Connection: keep-alive
Server: thin 1.3.1 codename Triple Espresso</pre></div>
</div>

      </div>

<p>If we pass in the correct username and password we’ll get the full JSON response.</p>

      <div class="code_block">
        <div class="code_header">
          terminal
        </div>
        <div class="CodeRay">
  <div class="code"><pre>$ curl http://localhost:3000/api/products -u "admin:secret"
[{"category_id":2,"created_at":"2012-05-30T20:16:58Z","id":1,"name":"Settlers of Catan","price":"29.95","released_on":"2012-04-12","updated_at":"2012-05-30T20:16:58Z"}, ...etc]</pre></div>
</div>

      </div>

<p>One thing to watch out for is that the credentials are sent as clear text so we should be sure to use a secure connection or maybe a digest connection.</p>

<h3>Authentication Via an Access Token</h3>

<p>Another way we can lock down our API is to provide the client with an access token.  We’ll need somewhere to store this token and we’ll do this in a new <code>api_key</code> model.</p>

      <div class="code_block">
        <div class="code_header">
          terminal
        </div>
        <div class="CodeRay">
  <div class="code"><pre>$ rails g model api_key access_token</pre></div>
</div>

      </div>

<p>There are other columns that we could add to this model. For example we could add a <code>role</code> column to specify the permissions that the token has, a <code>user_id</code> column to specify the user the token belongs to or an <code>expires_at</code> column to specify when the token expires. We’ll keep our model simple for now, though, with just the one column. We’ll need to run rake <code>db:migrate</code> to create the new <code>api_keys</code> table.</p>

<p>In our new model we’ll need to generate a random access token string each time a record is created. We’ll do this in a <code>before_create</code> callback.</p>

      <div class="code_block">
        <div class="code_header">
          /app/models/api_key.rb
        </div>
        <div class="CodeRay">
  <div class="code"><pre><span class="r">class</span> <span class="cl">ApiKey</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Base</span>
  before_create <span class="sy">:generate_access_token</span>

private

  <span class="r">def</span> <span class="fu">generate_access_token</span>
    <span class="r">begin</span>
      <span class="pc">self</span>.access_token = <span class="co">SecureRandom</span>.hex
    <span class="r">end</span> <span class="r">while</span> <span class="pc">self</span>.class.exists?(<span class="sy">access_token:</span> access_token)
  <span class="r">end</span>

<span class="r">end</span></pre></div>
</div>

      </div>

<p>This code uses <code>SecureRandom.hex</code>, which is provided in Ruby 1.9, to generate a random hexadecimal string. It then checks to see if another key exists with the same token and regenerates the token if this is the case. We could also add a unique constraint on this column on the database too, to ensure uniqueness. We can see this in action in the console. If we call <code>ApiKey.create!</code> we’ll generate a new record with a random token.</p>

      <div class="code_block">
        <div class="code_header">
          console
        </div>
        <div class="CodeRay">
  <div class="code"><pre><span class="fl">1.9</span>.<span class="i">3</span>-p125 :<span class="i">001</span> &gt; <span class="co">ApiKey</span>.create!
   (<span class="fl">0.1</span>ms)  <span class="r">begin</span> transaction
  <span class="co">ApiKey</span> <span class="co">Exists</span> (<span class="fl">0.2</span>ms)  <span class="co">SELECT</span> <span class="i">1</span> <span class="co">FROM</span> <span class="s"><span class="dl">"</span><span class="k">api_keys</span><span class="dl">"</span></span> <span class="co">WHERE</span> <span class="s"><span class="dl">"</span><span class="k">api_keys</span><span class="dl">"</span></span>.<span class="s"><span class="dl">"</span><span class="k">access_token</span><span class="dl">"</span></span> = <span class="s"><span class="dl">'</span><span class="k">afbadb4ff8485c0adcba486b4ca90cc4</span><span class="dl">'</span></span> <span class="co">LIMIT</span> <span class="i">1</span>
<span class="co">Binary</span> data inserted <span class="r">for</span> <span class="sh"><span class="dl">`</span><span class="k">string</span><span class="dl">`</span></span> type on column <span class="sh"><span class="dl">`</span><span class="k">access_token</span><span class="dl">`</span></span>
  <span class="co">SQL</span> (<span class="fl">5.9</span>ms)  <span class="co">INSERT</span> <span class="co">INTO</span> <span class="s"><span class="dl">"</span><span class="k">api_keys</span><span class="dl">"</span></span> (<span class="s"><span class="dl">"</span><span class="k">access_token</span><span class="dl">"</span></span>, <span class="s"><span class="dl">"</span><span class="k">created_at</span><span class="dl">"</span></span>, <span class="s"><span class="dl">"</span><span class="k">updated_at</span><span class="dl">"</span></span>) <span class="co">VALUES</span> (<span class="i">?,</span> ?, <span class="i">?)</span>  [[<span class="s"><span class="dl">"</span><span class="k">access_token</span><span class="dl">"</span></span>, <span class="s"><span class="dl">"</span><span class="k">afbadb4ff8485c0adcba486b4ca90cc4</span><span class="dl">"</span></span>], [<span class="s"><span class="dl">"</span><span class="k">created_at</span><span class="dl">"</span></span>, <span class="co">Wed</span>, <span class="i">30</span> <span class="co">May</span> <span class="i">2012</span> <span class="i">21</span>:<span class="i">17</span>:<span class="i">53</span> <span class="co">UTC</span> <span class="i">+00</span>:<span class="i">00</span>], [<span class="s"><span class="dl">"</span><span class="k">updated_at</span><span class="dl">"</span></span>, <span class="co">Wed</span>, <span class="i">30</span> <span class="co">May</span> <span class="i">2012</span> <span class="i">21</span>:<span class="i">17</span>:<span class="i">53</span> <span class="co">UTC</span> <span class="i">+00</span>:<span class="i">00</span>]]
   (<span class="fl">2.7</span>ms)  commit transaction
 =&gt; <span class="c">#&lt;ApiKey id: 1, access_token: "afbadb4ff8485c0adcba486b4ca90cc4", created_at: "2012-05-30 21:17:53", updated_at: "2012-05-30 21:17:53"&gt;</span></pre></div>
</div>

      </div>

<p>How we choose to generate this and display it to the client is up to us but it’s usually done on some kind of profile page so that they can copy and paste it into their API tool. Now we need to restrict access to the API by requiring that the token is passed in. There are several ways that we could do this. One way is to add it as a URL parameter when we can then check for and check in the controller. We’ll do this through a <code>before_filter</code>.</p>

      <div class="code_block">
        <div class="code_header">
          /app/controllers/api/v1/products_controller.rb
        </div>
        <div class="CodeRay">
  <div class="code"><pre><span class="r">module</span> <span class="cl">Api</span>
  <span class="r">module</span> <span class="cl">V1</span>
    <span class="r">class</span> <span class="cl">ProductsController</span> &lt; <span class="co">ApplicationController</span>
      before_filter <span class="sy">:restrict_access</span>
      respond_to <span class="sy">:json</span>

      <span class="c"># Actions omitted</span>

      private
      <span class="r">def</span> <span class="fu">restrict_access</span>
        api_key = <span class="co">ApiKey</span>.find_by_access_token(params[<span class="sy">:access_token</span>])
        head <span class="sy">:unauthorized</span> <span class="r">unless</span> api_key
      <span class="r">end</span>
    <span class="r">end</span>
  <span class="r">end</span>
<span class="r">end</span></pre></div>
</div>

      </div>

<p>In <code>restrict_access</code> we try to find an <code>ApiKey</code> by the <code>access_token</code> that’s passed in from the URL. If we fail to find a matching key we return <code>401 Unauthorized</code>. Now unless a valid access token is passed in we’ll just see a blank response when we browse to this page, though it we look in the server logs we’ll see that the server is returning a <code>401</code> response.</p>

<p>Passing in the access token through a URL isn’t the best solution, especially if the token never expires. People tend to copy and paste URLs and we don’t want them sharing their credentials. Instead we’ll pass the access token in via an HTTP header. Rails gives us some controller methods to make adding this functionality easy. We can use <code>authenticate_or_request_with_http_token</code> in a before filter. We have a before filter in our <code>ProductsController</code> so we’ll modify the  <code>restrict_access</code> method it calls to use <code>authenticate_or_request_with_http_token</code>.</p>

      <div class="code_block">
        <div class="code_header">
          /app/controllers/api/v1/products_controller.rb
        </div>
        <div class="CodeRay">
  <div class="code"><pre><span class="r">def</span> <span class="fu">restrict_access</span>
  authenticate_or_request_with_http_token <span class="r">do</span> |token, options|
    <span class="co">ApiKey</span>.exists?(<span class="sy">access_token:</span> token)
  <span class="r">end</span>
<span class="r">end</span></pre></div>
</div>

      </div>

<p>If the block that’s passed to <code>authenticate_or_request_with_http_token</code> returns <code>true</code> the authentication passes and so in here we check that an <code>ApiKey</code> exists with the token that’s passed in. Now when a request is made to the API access will be denied unless an <code>Authorization</code> header is set, like this:</p>

      <div class="code_block">
        <div class="code_header">
          terminal
        </div>
        <div class="CodeRay">
  <div class="code"><pre>$ curl http://localhost:3000/api/products -H 'Authorization: Token token="afbadb4ff8485c0adcba486b4ca90cc4"'</pre></div>
</div>

      </div>

<p>We could mix and match these different authentication token methods to best fit the needs of our application.</p>

<p>The different solutions we’ve covered here are fairly simple but what if the situation is a little more complicated? For example what if a user is able to log in to our application and we’d like other applications that use our API to be able to simulate logging in as that user and access their credentials, but only if that user gives the other application permission. This is a common scenario in social networking applications such as Facebook or Twitter and a great way to do this is to use <a href="http://railscasts.com/episodes/350-rest-api-versioning">OAuth</a>. We won’t be covering OAuth in any detail in this episode but there’s plenty of information about it on its website. Essentially it allows us to secure an API and protect users’ data without requiring them to store their passwords on every site they log in to.</p>

There are many projects available that help to make it easier to implement OAuth in  a Rails application. <a href="https://github.com/applicake/doorkeeper">Doorkeeper</a> is one of these and while its still in early development it’s worth taking a look at and so we’ll be covering this in this week’s Pro episode. The <a href="https://github.com/intridea/oauth2">oauth2</a> gem is also worth investigating. Many other projects build on this gem so it’s a good idea to get an understanding of how it works.

<p>With any of the solutions we’ve shown so far it’s very important the the API interaction happens over a secure connection so we need to make sure that we use SSL.</p>
  </div>
</div>
      <div class="progress" style="display: none"><img alt="loading" src="./#352 Securing an API - RailsCasts_files/progress_large-0325281c1bdeaa0c2b86f8a23aeb3210.gif"></div>
    </div>
</div>
    </div>
    <div id="footer">
      <div class="inner">
        ©2012 RailsCasts - <a href="http://railscasts.com/privacy">Privacy Policy</a> - Hosted by <a href="http://www.linode.com/?utm_source=railscasts.com&utm_medium=Badge&utm_campaign=Railscasts">Linode</a>
      </div>
    </div>

      <!-- Google Analytics -->
      <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-7696481-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>


<style>#sv #sublime_videos{position:static!important}#sv #sublime_videos,#sv #sublime_zoom{padding:0!important;margin:0!important;overflow:visible!important}#sv .sublime_video_wrapper{display:block;position:relative!important;line-height:0!important;background:#000!important;overflow:hidden!important;direction:ltr!important;padding:0!important;text-align:center!important;-webkit-user-select:none!important;-moz-user-select:none!important}#sv .sublime_video_wrapper *,#sv #sz_content_wrapper,#sv #sv_contextual_menu *{padding:0!important;margin:0!important;border:none!important;overflow:visible!important;position:static!important;background:none!important;float:none!important;z-index:auto!important}#sv #sublime_videos,#sv #sublime_zoom,#sv .sublime_video_wrapper,#sv .sublime_video_wrapper *,#sv_contextual_menu,#sv_contextual_menu *{-moz-box-sizing:content-box!important;-webkit-box-sizing:content-box!important;-ms-box-sizing:content-box!important;box-sizing:content-box!important}#sv .sublime_video_content{height:100%!important}#sv .sublime_video_wrapper img{position:absolute!important;top:0!important;left:0!important;bottom:auto!important;right:auto!important;max-width:none!important;-moz-border-radius:0!important;-webkit-border-radius:0!important;border-radius:0!important}#sv .sublime_video_wrapper span.sv_play_button{display:block;position:absolute!important;width:auto!important;height:auto!important;top:0!important;bottom:0!important;left:0!important;right:0!important;cursor:pointer!important;opacity:1!important;background-color:rgba(0,0,0,0.3)!important;background-position:50%!important;background-repeat:no-repeat!important;-webkit-transition:.5s background-color!important;-moz-transition:.5s background-color!important;-o-transition:.5s background-color!important}#sv .sublime_video_wrapper span.sv_play_button:hover{background-color:rgba(0,0,0,0)!important}#sv .sublime_video_wrapper span.sv_play_button.ie{width:100%!important;height:100%!important;line-height:0!important;background:url(http://cdn.sublimevideo.net/p/beta/ie/transparent_pixel.gif)!important;cursor:pointer!important;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4C000000,endColorstr=#4C000000)!important;zoom:1!important}#sv .sublime_video_wrapper span.sv_play_button.ie:hover{filter:none!important}#sv .sublime_video_wrapper span.sv_play_button.ie span{display:block;width:78px!important;height:78px!important;margin:-39px auto 0!important;position:relative!important;top:50%!important;cursor:pointer!important}#sv .sublime_video_wrapper .sv_error_messages{-webkit-user-select:auto;-moz-user-select:auto;user-select:auto}#sv .sublime_video_wrapper .sv_error_messages .sv_content td p a{color:#ccc!important;text-shadow:none!important;display:inline!important;padding:0!important;margin:0!important}#sv #sv_contextual_menu{margin:0!important;padding:6px 0 0 9px!important;border:none!important;background:url("data:image/png;charset=utf-8;base64,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") no-repeat!important;*background:none!important;width:126px!important;height:70px!important;position:absolute!important;bottom:auto!important;right:auto!important;z-index:999999!important}#sv #sv_contextual_menu_ie_bg{width:126px!important;height:70px!important;position:absolute!important;top:0!important;left:0!important;background:none!important;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="http://cdn.sublimevideo.net/p/beta/ie/contextual_background.png")!important}#sv #sv_contextual_menu.no_brand{height:50px!important;background:url("data:image/png;charset=utf-8;base64,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") no-repeat!important}#sv #sv_contextual_menu_ie_bg.no_brand{height:50px!important;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="http://cdn.sublimevideo.net/p/beta/ie/contextual_background_no_brand.png")!important}#sv #sv_contextual_menu span.logo{width:108px!important;height:24px!important;display:block!important;background:none!important;border:none!important;outline:none!important;padding:0!important;margin:0!important;position:static!important;cursor:pointer!important}#sv #sv_contextual_menu_transparent_layer{position:fixed!important;background:transparent!important;top:0!important;left:0!important;z-index:999998!important;width:100%!important;height:100%!important}#sv #sv_mode_switch{width:94px!important;height:18px!important;background:none!important;position:absolute!important;bottom:25px!important;left:16px!important;overflow:hidden!important}#sv #sv_mode_switch_handle_track{width:188px!important;height:18px!important;position:absolute!important;top:0!important;left:-47px!important}#sv #sv_mode_switch_handle{width:141px!important;height:18px!important;background:url("data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAI0AAAASCAQAAADMZ5W4AAAGP0lEQVR4XtWYW2wcVxnHf2cu3tm11/YmvqzjS0lzUajkkNhxnIuTPoCbNCEJ3YoWBIVI4YEIQVQhVAVFfaAIXkCIAkJIPFCFQosQGDsJhTRtcZukDm5IkyYNoU1cXzfxJd71eu3ZuRyi0ZFX1r5QyRuJ/9FqZr7vjOb//fYczTkjJMWQAJMyakKr27+xrMOMssRyZqbe6vuF/QF3yOAALH0dBsWSToSq9m/quwZwl952NPZou9b7HBnmcAD4P0MTEzsmAY2lls8ksR3EuMM0FBuNQAACFkeUJJJC5eMCDQFIfBXTKaEsE9EoljIRyihBB5AC1fKu1E8uVCYB5bWwpnz/PJp8dx1NFUhw1IMISDx8pGooC0EEDw+JwFAmPXK4Qf8gJikeGgklGIgAjIaBiYkOC668BXc6BkL9bSLop+GrrFKQ9VWli9EExalHIQJIJkZw7eHi5jkrfF7QbHL4aIQpw0RiB7PfRwHUKKLUM5R7iwgRjACJE5SYC5oX5CwMFdcJY6EFeQc/jwY36O8UojGJ8Gk6OMEobWyih0ba0BH4uPyKVjaR5CSCvdQxxl9Yz0Ze5D84mFTyTGArx/cVNAChFxtN3n0pu+lAD9B04bCfN3kNcLCoYDOdXKAXB4N1fJU13OA4t6jjMfp5hxV8lrc4EwCiEE3p8OMNieRk/Hzysfijo2NaW3wPSvwheSC+G7jJvPdtPTQzGO0b+1zd3ps3HhxGxyTKIQLxE+awUdIptvLuRw+s2E+g0SHp1R8eqml8GxdBmGXZo5GN9p7Qk8xhyJc8YyITX+9uNg6ObKn/evJUfCy5NX54uLbhbXLMF6IxsKZqG0jXxavTtXGmlvXc+HfTl2o7q3860D9z3ExVxQH74VBaD0E2Gq1M1dQxUfNgGA2T7fDGxIRz5u4v1aS8z2gMQlM1K/j14JXZrL9nfPXqeiZrGi1sDKI03QPjh+rZzGXiInIr/fq10pUr/W0Vqdp67lVbfa9q7lVvYSAK0eiYmg5rD3FoLSC0o3/jzPvPUt156shJhBCQcuT2bDbihzRA1w0IWUQpQRva0cgWy6pKOJRgoEkh7i8aHUPT4GtNwDUGrq4Dw6QC8Ci3Hw/xysiBxplE9NY1szS7pnxNh5O6+i5lJSFY28pv1gKajoleiAYkvpTwyp3h+baKT1X4DlnwXHDmmUPzfPhwsmXVXPZGqjmGkmZgAfK1ZPajkdstjYkmWjl1n0eNcu/78K/UbTs7l8j6HgiBhYtHxN0domXErg+3oz/kvnz1dG1zdGP5hp2c9oF3U/9MNVi7a6TERxauayQetueC9UZTv/9l1tvzzIDjQnAmXAdGL7bsCUcmLrFNwqznQayBNnJcf2J9+AGOjx+g7k96wkXeVzTKvevCe+f6L4bGEtOODdFyWnAYZnlpdcqJfiKdq7ZozdhPtqUvdfVFPtMcG6hybfAHm46XbOIJz8XGQxaicZhzXIgOtPZd2gfz82TAdcAOznIOlP15utPSx0+wzfUYdxxoSJCAqSMvjB/2rGPV/H08dyn/SkQWGY1c5N6B1f1PvYiDZtvQ9El+DKnf+ZUxfnZ5dGh57LmH7+498fyGdPOGr2yA99KXr61bBSL1SN87VeC4zOEUovHJkTnSPR3e1ds6dLTnprnlbMc0PN1zJ7z1/I5p5DM90+H+84+87kdePbk9Eb7+6ugPT35kSuniyM6bte9/vv6hZUO5dNeJD5nHFZKgacVGI5HK/czT3ePhLb1bJ/DQXzj3rQumkHg0XMlFklUHnz02+MeqTT+quHjm7L6XH+ioNNLu4NmuN7+bPNhX3/3Xod/2PrWzsvtchhw+SkKqIwY65sJqWM07BEIZCLLogK9MBVeAj492qqJr5Zrb3xlhjhyu8Cmnkeb9v6eI6v4iVxgiLZV7hFrhapQQUu68BYBqlY95bNXdSMXsDz7AVVlVMQ4eLjKPJn/T4l0TkN97qJy2kJHqDrVPURkfFx9fQCkrWLfvJT1CkeRle77AdUaZBancKwxq2wPKnb9QA2hBE0FUgVk0BheNmqXQYqQIsFjOyp3HqnZRJE2e/sf3GGCC+Y/3vWbxJrT4HyUKnXlkGb/w83Yj1m6UscRyM3f7+p5nglm8j+/1f+P4X8QyxtJ5FTCLAAAAAElFTkSuQmCC") no-repeat!important;position:absolute!important;top:0!important}*+html #sv_mode_switch_handle{background:url(http://cdn.sublimevideo.net/p/beta/ie/handle_and_labels.png) no-repeat!important}* html #sv_mode_switch_handle{background:none!important;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="http://cdn.sublimevideo.net/p/beta/ie/handle_and_labels.png")!important}#sv #sublime_zoom{position:absolute!important;top:0!important;left:0!important;width:auto!important;height:auto!important;z-index:999998!important}#sv #sz_close_button{padding:0!important;margin:0!important;border:none!important;width:45px!important;height:45px!important;position:absolute!important;cursor:pointer!important;z-index:4!important;opacity:0!important;-webkit-transition:opacity .4s!important;-moz-transition:opacity .4s!important;-o-transition:opacity .4s!important;transition:opacity .4s!important;display:none\9!important}* html #sz_close_button{display:block!important}#sv #sz_content_wrapper:hover #sz_close_button{opacity:1!important;display:block\9!important}</style></body></html>